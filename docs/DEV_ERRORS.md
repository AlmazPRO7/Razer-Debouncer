# Журнал ошибок и исправлений (Dev Error Log)

Формат записей: дата, источник (пользователь/QA), кратко суть, анализ, изменения в коде, итог/проверка.

## 2025-08-15 — IndentationError при запуске bw3_debounce3.py
- Источник: пользователь (PowerShell).
- Симптом: `IndentationError: unexpected indent` в блоке первого DOWN.
- Анализ: лишний отступ перед `if deb.debug: print(...)` и `return CallNextHookEx`.
- Изменения: выравнивание отступов (bw3_debounce3.py, ~строки 560–590).
- Итог: `py_compile` проходит, запуск ок.

## 2025-08-15 — Ограничение нескольких копий скрипта
- Источник: пользователь.
- Симптом: требуется блокировать запуск параллельных экземпляров.
- Анализ: отсутствовал механизм single-instance.
- Изменения: добавлена `ensure_single_instance()` на WinAPI (CreateMutexW), флаг `--allow-multiple` (bw3_debounce3.py).
- Итог: второй процесс завершает работу, выводит уведомление.

## 2025-08-15 — Медленные аккорды (Ctrl+1)
- Источник: пользователь.
- Симптом: приходится «выдерживать» Ctrl перед цифрой.
- Анализ: пост‑UP фильтр блокировал первый быстрый DOWN в контексте зажатого модификатора.
- Изменения: введён аккорд‑байпас пост‑UP для первого DOWN немодификатора при зажатом модификаторе; флаг `--no-chord-bypass` (bw3_debounce3.py). Добавлены события в лог: `CHORD_BYPASS`, `CHORD_GUARD`.
- Итог: бинды срабатывают без задержки; при необходимости откат флагом.

## 2025-08-15 — Настройка Ubuntu (Python 3.11, автотесты)
- Источник: пользователь.
- Симптом: нужно стандартизировать окружение.
- Анализ: отсутствовал скрипт установки и dev‑зависимости.
- Изменения: `scripts/setup_ubuntu.sh`, `requirements-dev.txt`, `docs/UBUNTU_SETUP.md`, базовый `pytest` тест.
- Итог: окружение готовится одной командой, тесты запускаются в WSL.

## 2025-08-15 — В репозиторий попали лишние артефакты и логи
- Источник: внутренняя проверка Dev Agent.
- Симптом: в истории репозитория присутствовали служебные каталоги и диагностические файлы (`.codex/`, `build/`, `dist/`, `.venv/`, `.secrets/`, `~\AppData\Roaming/*`, `fetch*.out/err`, `lsremote*.out/err`, `ssh*.out/err`, `.DS_Store`, `Thumbs.db`).
- Анализ: часть файлов не была корректно проигнорирована ранее; отдельные логи и проверочные файлы попали в индекс и историю.
- Изменения: уточнён `.gitignore` (добавлены исключения, оставлена явная поддержка `!bw3_debounce.spec`); выполнена перепись истории `git filter-branch` с удалением артефактов, далее `git reflog expire --expire=now --all` и `git gc --prune=now --aggressive`. Создан резервный тег `before-history-rewrite-YYYYMMDD-HHMMSS`.
- Итог/проверка: пути выше отсутствуют в выходе `git log --all -- <path>`; размер репозитория уменьшен; HEAD — актуален. Изменения запушены на `origin` с `--force-with-lease`.
- Инструкция для разработчиков: выполнить `git fetch --all`, затем для основной ветки `git checkout main && git reset --hard origin/main`. Если есть локальные коммиты — перенесите их через `git rebase --onto origin/main <old-base> main` или `git cherry-pick`.
